<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Evaluador Restaurante</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    label, input { display: block; margin-bottom: 10px; }
    table { border-collapse: collapse; margin-top: 20px; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: right; }
  </style>
</head>
<body>

<h2>Evaluador de Restaurante</h2>

<label>Ventas mensuales (en millones):
  <input type="number" id="ventasBase" value="50">
</label>
<p>Ventas con IVA: $<span id="ventasIVA">-</span></p>
<p>Ventas netas: $<span id="ventasNetas">-</span></p>

<label>Inversión inicial (en millones):
  <input type="number" id="inversion" value="10">
</label>
<p>Inversión inicial: $<span id="inversionMonto">-</span></p>

<label>Arriendo mensual (en millones):
  <input type="number" id="arriendoFijo" value="5">
</label>
<p>Arriendo: $<span id="arriendoMonto">-</span> (<span id="porcArriendo">-</span>% de ventas netas)</p>

<table>
  <thead>
    <tr>
      <th>Mes</th>
      <th>% Estacionalidad</th>
      <th>Flujo estimado</th>
    </tr>
  </thead>
  <tbody id="tablaEstacionalidad"></tbody>
</table>

<p>Flujo mensual estimado: $<span id="flujoMensual">-</span></p>
<p>Flujo anual ajustado: $<span id="flujoAnual">-</span></p>
<p>ROI estimado: <span id="roi">-</span>%</p>
<p>Payback estimado: <span id="payback">-</span> meses</p>

<script>
const estacionalidad = [84, 50, 92, 94, 84, 95, 99, 100, 60, 98, 92, 93];
const meses = ['Ene','Feb','Mar','Abr','May','Jun','Jul','Ago','Sep','Oct','Nov','Dic'];

function formatear(valor) {
  return valor.toLocaleString('es-CL');
}

function calcular() {
  const ventasMillones = parseFloat(document.getElementById('ventasBase').value) || 0;
  const inversionMillones = parseFloat(document.getElementById('inversion').value) || 0;
  const arriendoMillones = parseFloat(document.getElementById('arriendoFijo').value) || 0;

  const ventasIVA = ventasMillones * 1_000_000;
  const ventasNetas = ventasIVA / 1.19;
  const inversion = inversionMillones * 1_000_000;
  const arriendo = arriendoMillones * 1_000_000;

  const porcArriendo = (arriendo / ventasNetas) * 100;

  const gastos = ventasNetas * (0.385 + 0.20 + 0.20 + 0.03) + arriendo;
  const flujoMensual = ventasNetas - gastos;

  let flujoAnual = 0;
  let tablaHTML = '';
  estacionalidad.forEach((porc, i) => {
    const flujoMes = flujoMensual * (porc / 100);
    flujoAnual += flujoMes;
    tablaHTML += `<tr><td>${meses[i]}</td><td>${porc}%</td><td>$${formatear(flujoMes.toFixed(0))}</td></tr>`;
  });

  const roi = (flujoAnual / inversion) * 100;
  const payback = inversion / flujoMensual;

  document.getElementById('ventasIVA').textContent = formatear(ventasIVA);
  document.getElementById('ventasNetas').textContent = formatear(ventasNetas);
  document.getElementById('inversionMonto').textContent = formatear(inversion);
  document.getElementById('arriendoMonto').textContent = formatear(arriendo);
  document.getElementById('porcArriendo').textContent = porcArriendo.toFixed(1);

  document.getElementById('flujoMensual').textContent = formatear(flujoMensual.toFixed(0));
  document.getElementById('flujoAnual').textContent = formatear(flujoAnual.toFixed(0));
  document.getElementById('roi').textContent = roi.toFixed(2);
  document.getElementById('payback').textContent = payback.toFixed(1);

  document.getElementById('tablaEstacionalidad').innerHTML = tablaHTML;
}

document.querySelectorAll('input').forEach(input => {
  input.addEventListener('input', calcular);
});

window.addEventListener('DOMContentLoaded', calcular);
</script>

</body>
</html>
